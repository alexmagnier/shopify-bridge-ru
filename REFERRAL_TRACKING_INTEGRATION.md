# üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¢—Ä–µ–∫–∏–Ω–≥–∞

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. **–°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–∏–¥–æ–≤** (`src/utils/leadSubmission.ts`)

–§—É–Ω–∫—Ü–∏–∏:
- `getRefCode()` - –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏–∑ cookie/localStorage
- `submitLead(formData)` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫—É –Ω–∞ Edge Function —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
- `useLeadSubmission()` - React —Ö—É–∫ –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞–º–∏

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ö–æ–Ω—Ç–∞–∫—Ç–æ–≤** (`src/App.tsx`)

‚úÖ –§–æ—Ä–º–∞ `/contact` —Ç–µ–ø–µ—Ä—å:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ Supabase Edge Function
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏—à–µ–ª –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π —Å—Å—ã–ª–∫–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ (‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...)
- –û—á–∏—â–∞–µ—Ç —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏

### 3. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫–∏–Ω–≥** (—É–∂–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω —Ä–∞–Ω–µ–µ)

‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `ReferralTracker` (–≤—Å—Ç—Ä–æ–µ–Ω –≤ `App.tsx`):
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç `?ref=CODE` –∏–∑ URL –≤ cookie –∏ localStorage
- Cookie –∂–∏–≤–µ—Ç 90 –¥–Ω–µ–π
- localStorage –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π

---

## üîó –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢

### –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É:

```
1. –ü–∞—Ä—Ç–Ω–µ—Ä –¥–µ–ª–∏—Ç—Å—è —Å—Å—ã–ª–∫–æ–π: https://shopify-bridge.ru/?ref=PARTNER123
   
2. –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É
   ‚Üì
   ReferralTracker —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç PARTNER123 –≤ cookie + localStorage
   
3. –ö–ª–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –Ω–∞ /contact (–∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
   ‚Üì
   submitLead() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
   
4. –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ Supabase Edge Function:
   POST /functions/v1/submit-lead
   {
     "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
     "contact": "ivan@example.com",
     "product": "–¢–æ–≤–∞—Ä",
     "volume": "10-50",
     "notes": "–°–æ–æ–±—â–µ–Ω–∏–µ",
     "ref": "PARTNER123"  ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
   }
   
5. Edge Function:
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ referrals
   - –°–≤—è–∑—ã–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º
   - –ù–∞—á–∏—Å–ª—è–µ—Ç –∫–æ–º–∏—Å—Å–∏—é –ø–∞—Ä—Ç–Ω–µ—Ä—É –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
```

---

## üìù –ö–ê–ö –î–û–ë–ê–í–ò–¢–¨ –¢–†–ï–ö–ò–ù–ì –í –ù–û–í–´–ï –§–û–†–ú–´

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ–æ—Ä–º—É:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```typescript
import { submitLead } from '@/utils/leadSubmission';

const handleSubmit = async (e: React.FormEvent) => {
  e.preventDefault();
  
  const result = await submitLead({
    name: formData.name,
    contact: formData.email,
    product: formData.product,
    message: formData.message,
  });
  
  if (result.success) {
    alert('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
  } else {
    alert('‚ùå –û—à–∏–±–∫–∞: ' + result.message);
  }
};
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –° React —Ö—É–∫–æ–º (–±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ)

```typescript
import { useLeadSubmission } from '@/utils/leadSubmission';

function MyForm() {
  const { submit, isSubmitting, error } = useLeadSubmission();
  
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    const result = await submit({
      name: formData.name,
      contact: formData.email,
    });
    
    if (result.success) {
      // –£—Å–ø–µ—Ö
    }
  };
  
  return (
    <form onSubmit={handleSubmit}>
      {/* ... –ø–æ–ª—è —Ñ–æ—Ä–º—ã ... */}
      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...' : '–û—Ç–ø—Ä–∞–≤–∏—Ç—å'}
      </button>
      {error && <div>–û—à–∏–±–∫–∞: {error}</div>}
    </form>
  );
}
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. **–ó–∞—Ä–µ–≥–∞–π —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:**
   - –û—Ç–∫—Ä–æ–π `/partners/register`
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è
   - –°–∫–æ–ø–∏—Ä—É–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/?ref=ABC123`)

2. **–û—Ç–∫—Ä–æ–π —Å—Å—ã–ª–∫—É –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ:**
   - `https://shopify-bridge.ru/?ref=ABC123`
   - –ü—Ä–æ–≤–µ—Ä—å –≤ DevTools ‚Üí Application ‚Üí Cookies: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `sb_ref=ABC123`
   - –ü—Ä–æ–≤–µ—Ä—å –≤ DevTools ‚Üí Application ‚Üí Local Storage: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `sb_ref=ABC123`

3. **–ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É:**
   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ `/contact`
   - –ó–∞–ø–æ–ª–Ω–∏ –∏ –æ—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ä–º—É
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!"

4. **–ü—Ä–æ–≤–µ—Ä—å –≤ Supabase:**
   - –û—Ç–∫—Ä–æ–π [Supabase Dashboard](https://supabase.com/dashboard)
   - Table Editor ‚Üí `referrals`
   - –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å `partner_id` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º `ref=ABC123`

5. **–ü—Ä–æ–≤–µ—Ä—å –≤ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ:**
   - –í–æ–π–¥–∏ –≤ `/partners/dashboard`
   - –í —Ä–∞–∑–¥–µ–ª–µ "–†–µ—Ñ–µ—Ä–∞–ª—ã" –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–π –ª–∏–¥

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ê SUPABASE EDGE FUNCTION

### URL Edge Function:
```
https://oyjxzrvhvndbdoyshwfc.supabase.co/functions/v1/submit-lead
```

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å URL:

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Ñ–∞–π–ª `src/utils/leadSubmission.ts`:

```typescript
const SUPABASE_FUNCTION_URL = 'https://YOUR_PROJECT.supabase.co/functions/v1/submit-lead';
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Edge Function:

1. –û—Ç–∫—Ä–æ–π [Supabase Dashboard](https://supabase.com/dashboard)
2. –°–ª–µ–≤–∞ –Ω–∞–π–¥–∏ **Edge Functions** ‚ö°
3. –í—ã–±–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏—é `submit-lead`
4. –í–∫–ª–∞–¥–∫–∞ **Logs**

–ó–¥–µ—Å—å –±—É–¥—É—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—à–∏–±–∫–∏.

---

## üö® TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: –§–æ—Ä–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π DevTools ‚Üí Console
2. –ü—Ä–æ–≤–µ—Ä—å –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Edge Function –∑–∞–ø—É—â–µ–Ω–∞ –≤ Supabase Dashboard

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `ReferralTracker` –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ `App.tsx`
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤ URL –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `?ref=CODE`
3. –ü—Ä–æ–≤–µ—Ä—å cookie –≤ DevTools ‚Üí Application ‚Üí Cookies

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–∞—Ä—Ç–Ω–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç —Å–≤–æ–∏—Ö –ª–∏–¥–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É `referrals` –≤ Supabase
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ `partner_id` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## ‚ú® –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –§–æ—Ä–º—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ Supabase
- ‚úÖ –ü–∞—Ä—Ç–Ω–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –∫–æ–º–∏—Å—Å–∏–∏
- ‚úÖ –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–¥–µ–ø–ª–æ–π –Ω–∞ Vercel –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ! üöÄ

